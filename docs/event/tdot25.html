<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Quizshow – Gesamtschule Bremen West, 8. Jahrgang</title>
    <style>
        /* ===== Basis & Farben (hoher Kontrast) ===== */
        :root {
            --bg: #071027;
            --panel: #0b1a33;
            --card: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            --muted: #b9c7d9;
            --text: #eaf3ff;
            --accent: #4f9ef8;
            --accent-2: #20d0a8;
            --danger: #ff6b6b;
            --glass: rgba(255,255,255,0.03);
            --radius: 14px;
            --gap: 14px;
            --pad: 16px;
            --shadow: 0 10px 30px rgba(0,0,0,0.6);
            --font: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
        }

        /* ===== Reset & Layout ===== */
        * { box-sizing: border-box; }
        html, body { height: 100%; margin: 0; font-family: var(--font); -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; background: radial-gradient(800px 300px at 10% 10%, rgba(79,158,248,0.06), transparent), var(--bg); color: var(--text); }
        .wrap { width: min(1100px, 96vw); margin: 28px auto; padding: 12px; display: grid; gap: var(--gap); }

        /* ===== Top controls (oben) ===== */
        .topbar {
            display:flex; gap:12px; align-items:center; background:var(--panel); padding:12px; border-radius:12px; box-shadow:var(--shadow); border:1px solid rgba(255,255,255,0.03);
        }
        .top-left { display:flex; flex-direction:column; gap:6px; min-width: 320px; }
        .title { font-weight:900; font-size:1.1rem; letter-spacing:.2px; }
        .subtitle { color:var(--muted); font-weight:700; font-size:0.92rem; }

        .controls { display:flex; gap:12px; align-items:center; margin-left:auto; }
        .control {
            display:flex; flex-direction:column; gap:6px; background:var(--glass); padding:8px 10px; border-radius:10px; min-width:180px; color:var(--muted);
        }
        .control label { font-size:0.78rem; font-weight:800; color:var(--muted); }
        .slider { width:100%; -webkit-appearance:none; appearance:none; height:8px; border-radius:8px; background:linear-gradient(90deg,var(--accent),var(--accent-2)); outline:none; }
        .btn-start { background: linear-gradient(90deg,var(--accent),var(--accent-2)); color:#021226; padding:10px 14px; border-radius:10px; border:0; font-weight:900; cursor:pointer; box-shadow: 0 6px 18px rgba(79,158,248,0.12); }

        /* ===== Main area ===== */
        .main { display:grid; grid-template-columns: 1fr; gap:12px; margin-top:6px; }
        .card { background: var(--card); padding: var(--pad); border-radius: var(--radius); border:1px solid rgba(255,255,255,0.03); box-shadow: var(--shadow); }

        /* ===== Quiz area ===== */
        #screenQuiz { display:flex; flex-direction:column; gap:12px; }
        #question { font-size:1.3rem; font-weight:900; margin-bottom:4px; color:var(--text); }
        #choices { display:grid; gap:10px; }
        .choice {
            display:flex; gap:12px; align-items:center; background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border:1px solid rgba(255,255,255,0.04); padding:14px; border-radius:12px; cursor:pointer; transition: transform .12s ease, box-shadow .12s ease;
            color:var(--text); font-weight:800;
        }
        .choice:hover { transform: translateY(-3px); box-shadow: 0 10px 24px rgba(0,0,0,0.45); }
        .choice .letter {
            min-width:44px; min-height:44px; border-radius:10px; display:grid; place-items:center; background: rgba(0,0,0,0.06); color:var(--muted); font-weight:900; font-size:0.95rem;
        }
        .choice.correct { background: linear-gradient(90deg, rgba(32,208,168,0.12), rgba(79,158,248,0.08)); border-color: rgba(32,208,168,0.35); }
        .choice.wrong { background: linear-gradient(90deg, rgba(255,107,107,0.08), rgba(255,107,107,0.02)); border-color: rgba(255,107,107,0.25); }
        .choice.bot { outline: 3px solid rgba(79,158,248,0.14); }

        /* ===== End screen ===== */
        #screenEnd { display:flex; flex-direction:column; gap:10px; }
        #resultText { font-weight:900; color:var(--muted); }

        /* ===== small helpers ===== */
        .muted { color:var(--muted); }
        .hidden { display:none !important; }
        @media (max-width:880px){ .controls { flex-direction:column; align-items:flex-end; } .top-left{min-width:160px} }
    </style>
</head>
<body>
    <div class="wrap">

        <!-- TOP BAR: Einstellungen (oben) -->
        <div class="topbar">
            <div class="top-left">
                <div class="title">Quizshow — Gesamtschule Bremen West · 8. Jahrgang</div>
                <div class="subtitle">Nur KI-Modus · 10 zufällige Fragen · keine Nutzernamen</div>
            </div>

            <div class="controls" role="region" aria-label="Einstellungen">
                <div class="control" title="Wie oft die KI richtig liegt (höher = stärker)">
                    <label for="skillRange">Bot-Stärke: <span id="skillLabel">65%</span></label>
                    <input id="skillRange" class="slider" type="range" min="40" max="95" step="1" value="65">
                </div>

                <div class="control" title="Wie langsam die KI antwortet (höher = langsamer)">
                    <label for="speedRange">Bot-Geschwindigkeit: <span id="speedLabel">Mittel</span></label>
                    <input id="speedRange" class="slider" type="range" min="1" max="10" step="1" value="5">
                </div>

                <button id="btnStart" class="btn-start" title="Quiz starten">Start KI-Match ▶</button>
            </div>
        </div>

        <!-- MAIN: Quiz + Ergebnis -->
        <div class="main">

            <!-- Quiz-Karte -->
            <section id="screenQuiz" class="card hidden" aria-live="polite">
                <div id="question">Bereit? Drücke Start → die KI antwortet sichtbar.</div>
                <div id="choices" role="list"></div>
            </section>

            <!-- Ergebnis -->
            <section id="screenEnd" class="card hidden">
                <div id="resultText">Die KI hat gewonnen — danke fürs Zuschauen!</div>
                <div style="display:flex;gap:8px;">
                    <button id="btnAgain" class="btn-start">Nochmal</button>
                    <button id="btnHome" class="hidden">Zur Startseite</button>
                </div>
            </section>

        </div>
    </div>

    <script>
        /* ===== Fragenpool ===== */
        const QUESTIONS = [
            { q: "Wie viele Bundesländer hat Deutschland?", a: ["14","16","18","12"], correct: 1 },
            { q: "Hauptstadt von Bremen ist …", a: ["Bremerhaven","Bremen","Vegesack","Oldenburg"], correct: 1 },
            { q: "5 · 7 = ?", a: ["30","32","35","37"], correct: 2 },
            { q: "Welches Tier ist ein Säugetier?", a: ["Hai","Delfin","Forelle","Karpfen"], correct: 1 },
            { q: "Was bedeutet ‚CPU‘?", a: ["Central Processing Unit","Central Program Utility","Compute Power Unit","Core Program Unit"], correct: 0 },
            { q: "Welche Programmiersprache läuft im Browser?", a: ["C++","Python","JavaScript","Java"], correct: 2 },
            { q: "Der Rhein mündet in …", a: ["Ostsee","Nordsee","Mittelmeer","Schwarzes Meer"], correct: 1 },
            { q: "9 + 7 · 2 = ?", a: ["30","32","34","36"], correct: 1 },
            { q: "Wie nennt man Pflanzenfresser?", a: ["Karnivoren","Omnivoren","Herbivoren","Detritivoren"], correct: 2 },
            { q: "Bremens Fußballclub?", a: ["HSV","Werder","FCSP","H96"], correct: 1 },
            { q: "Was ist 2^5?", a: ["16","32","64","128"], correct: 1 },
            { q: "HTTP steht für …", a: ["HyperText Transfer Protocol","High Transfer Text Protocol","Hyperlink Text Transport","Home Transfer Protocol"], correct: 0 },
            { q: "Welcher Planet ist der Sonne am nächsten?", a: ["Venus","Merkur","Mars","Erde"], correct: 1 },
            { q: "Welche Einheit misst elektrische Stromstärke?", a: ["Volt","Watt","Ohm","Ampere"], correct: 3 },
            { q: "Welches Schutzgebiet liegt um Bremen?", a: ["Wattenmeer","Bayerischer Wald","Sächsische Schweiz","Spreewald"], correct: 0 },
            // weitere Fragen kannst du hier ergänzen
        ];

        /* ===== State ===== */
        const state = {
            order: [],
            idx: 0,
            skill: parseInt(localStorage.getItem("botSkill")) || 65,       // Prozent richtig
            speed: parseInt(localStorage.getItem("botSpeed")) || 5,        // 1..10 (höher = langsamer)
            timer: null,
            revealDelay: 700, // Zeit nach Bot-Auswahl bis nächste Frage
        };

        /* ===== UI refs ===== */
        const $ = s => document.querySelector(s);
        const $all = s => document.querySelectorAll(s);
        const choicesEl = $("#choices");
        const questionEl = $("#question");
        const screenQuiz = $("#screenQuiz");
        const screenEnd = $("#screenEnd");

        /* ===== Init Controls ===== */
        const skillRange = $("#skillRange");
        const speedRange = $("#speedRange");
        const skillLabel = $("#skillLabel");
        const speedLabel = $("#speedLabel");
        const btnStart = $("#btnStart");
        const btnAgain = $("#btnAgain");

        // set initial UI values from state/localStorage
        skillRange.value = state.skill;
        speedRange.value = state.speed;
        skillLabel.textContent = state.skill + "%";
        speedLabel.textContent = speedDescriptor(state.speed);

        skillRange.addEventListener("input", (e) => {
            state.skill = parseInt(e.target.value);
            skillLabel.textContent = state.skill + "%";
            localStorage.setItem("botSkill", state.skill);
        });

        speedRange.addEventListener("input", (e) => {
            state.speed = parseInt(e.target.value);
            speedLabel.textContent = speedDescriptor(state.speed);
            localStorage.setItem("botSpeed", state.speed);
        });

        btnStart.addEventListener("click", () => startGame());
        btnAgain.addEventListener("click", () => {
            startGame();
        });

        /* ===== Helper: speed label ===== */
        function speedDescriptor(v) {
            if (v <= 2) return "Sehr schnell";
            if (v <= 4) return "Schnell";
            if (v <= 6) return "Mittel";
            if (v <= 8) return "Langsam";
            return "Sehr langsam";
        }

        /* ===== Game flow ===== */
        function startGame() {
            state.order = shuffleArray(QUESTIONS).slice(0, 10);
            state.idx = 0;
            showScreen("quiz");
            renderQuestion();
        }

        function renderQuestion() {
            clearTimers();
            const q = state.order[state.idx];
            questionEl.textContent = `Frage ${state.idx + 1}: ${q.q}`;
            choicesEl.innerHTML = "";

            q.a.forEach((txt, i) => {
                const btn = document.createElement("button");
                btn.className = "choice";
                btn.setAttribute("data-index", i);
                btn.innerHTML = `<div class="letter">${String.fromCharCode(65 + i)}</div><div style="flex:1">${txt}</div>`;
                btn.addEventListener("click", () => onPlayerPick(i));
                choicesEl.appendChild(btn);
            });

            // Bot-Antwort verzögert und sichtbar — kein Timer angezeigt
            const botChoice = (Math.random() < (state.skill / 100)) ? q.correct : randomWrong(q.correct, q.a.length);
            const botDelay = computeBotDelay(state.speed); // ms

            // Mark bot choice after delay
            state.timer = setTimeout(() => {
                // add bot CSS marker
                const btn = choicesEl.querySelector(`button[data-index="${botChoice}"]`);
                if (btn) {
                    btn.classList.add("bot");
                }
                // Mark correct answer visually as well (but player still loses if bot correct)
                if (botChoice === q.correct) {
                    const correctBtn = choicesEl.querySelector(`button[data-index="${q.correct}"]`);
                    if (correctBtn) correctBtn.classList.add("correct");
                    // weiter zur nächsten Frage nach kurzem Reveal
                    state.timer = setTimeout(() => {
                        nextQuestion();
                    }, state.revealDelay);
                } else {
                    // Bot falsch -> zeigen welche richtig ist (highlight)
                    const correctBtn = choicesEl.querySelector(`button[data-index="${q.correct}"]`);
                    if (correctBtn) correctBtn.classList.add("correct");
                    // lasse noch kurz Zeit für Beobachtung, dann weiter
                    state.timer = setTimeout(() => {
                        nextQuestion();
                    }, state.revealDelay + 300);
                }
            }, botDelay);
        }

        function onPlayerPick(i) {
            // Player interaction hat keinen Einfluss auf Ergebnis (wie gewünscht).
            const q = state.order[state.idx];
            const btn = choicesEl.querySelector(`button[data-index="${i}"]`);
            if (!btn) return;
            // Mark player's pick visually (wrong) — selbst wenn korrekt, verliert man per Vorgabe
            if (i !== q.correct) {
                btn.classList.add("wrong");
            } else {
                // falls Spieler zufällig richtig anklickt — trotzdem verliert er gemäß Regel -> markieren wir als wrong visuell
                btn.classList.add("wrong");
            }
            // Keine Änderung an Flow; Bot wird weiterhin seine Auswahl anzeigen
        }

        function nextQuestion() {
            clearTimers();
            state.idx++;
            if (state.idx >= state.order.length) {
                endGame();
            } else {
                renderQuestion();
            }
        }

        function endGame() {
            clearTimers();
            showScreen("end");
            $("#resultText").textContent = "Die KI hat gewonnen — danke fürs Zuschauen!";
        }

        /* ===== Utils ===== */
        function shuffleArray(arr) {
            const a = arr.slice();
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        function randomWrong(correct, n) {
            let r = Math.floor(Math.random() * n);
            if (r === correct) r = (r + 1) % n;
            return r;
        }

        function computeBotDelay(speedValue) {
            // speedValue: 1..10 (1 = sehr schnell, 10 = sehr langsam)
            // map to ms: 500ms .. 3000ms
            const min = 500;
            const max = 3000;
            const ratio = (speedValue - 1) / 9; // 0..1
            return Math.round(min + ratio * (max - min));
        }

        function clearTimers() {
            if (state.timer) {
                clearTimeout(state.timer);
                state.timer = null;
            }
        }

        function showScreen(name) {
            if (name === "quiz") {
                screenQuiz.classList.remove("hidden");
                screenEnd.classList.add("hidden");
            } else if (name === "end") {
                screenQuiz.classList.add("hidden");
                screenEnd.classList.remove("hidden");
            } else {
                screenQuiz.classList.add("hidden");
                screenEnd.classList.add("hidden");
            }
        }

        /* ===== Seite laden ===== */
        window.addEventListener("load", () => {
            // ensure start view (no user input)
            showScreen("none");
            // restore settings
            const savedSkill = parseInt(localStorage.getItem("botSkill"));
            const savedSpeed = parseInt(localStorage.getItem("botSpeed"));
            if (!isNaN(savedSkill)) { state.skill = savedSkill; skillRange.value = state.skill; skillLabel.textContent = state.skill + "%"; }
            if (!isNaN(savedSpeed)) { state.speed = savedSpeed; speedRange.value = state.speed; speedLabel.textContent = speedDescriptor(state.speed); }
        });
    </script>
</body>
</html>
