<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Quizshow ‚Äì Gesamtschule Bremen West, 8. Jahrgang</title>
    <style>
        /* ===== Farben & Basis ===== */
        :root{
            --bg-1: #0f172a;
            --bg-2: #071029;
            --card: rgba(255,255,255,0.04);
            --glass: rgba(255,255,255,0.04);
            --muted: #9aa7bd;
            --accent: #4f9ef8;
            --accent-2: #20d0a8;
            --danger: #ff6b6b;
            --btn-txt: #031026;
            --radius: 16px;
            --gap: 16px;
            --pad: 18px;
            --shadow: 0 10px 30px rgba(2,6,23,0.6);
            --ui-gap: 12px;
            --font: "Inter", system-ui, Roboto, "Segoe UI", Arial;
        }
        @media (prefers-color-scheme: light){
            :root{
                --bg-1: #e9f0ff;
                --bg-2: #ffffff;
                --card: rgba(4,8,20,0.03);
                --glass: rgba(255,255,255,0.85);
                --muted: #51607a;
                --btn-txt: #00142a;
                --shadow: 0 8px 20px rgba(12,20,40,0.06);
            }
        }

        /* ===== Reset & Layout ===== */
        *{box-sizing:border-box}
        html,body{height:100%;margin:0;font-family:var(--font);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
        body{
            background: radial-gradient(1200px 400px at 10% 10%, rgba(79,158,248,0.08), transparent 10%),
                        linear-gradient(180deg,var(--bg-1),var(--bg-2));
            color:#e6eef9;
            display:flex;
            align-items:center;
            justify-content:center;
            padding:28px;
        }
        .app{width:min(1100px,96vw);max-width:1100px;display:grid;grid-template-columns:1fr 420px;gap:24px;align-items:start}
        @media (max-width:980px){ .app{grid-template-columns:1fr; padding-bottom:40px} }

        /* ===== Left: Main Card ===== */
        .card{
            background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border-radius:var(--radius);
            padding:var(--pad);
            box-shadow:var(--shadow);
            border:1px solid rgba(255,255,255,0.03);
        }
        .big-title{font-size:1.4rem;margin:0 0 6px 0;font-weight:800;letter-spacing:0.2px}
        .sub{color:var(--muted);font-weight:600;margin:0 0 14px 0}

        /* ===== Start-Card (links oben) ===== */
        #screenStart .row{display:flex;gap:12px;align-items:center}
        .input{
            display:block;width:100%;padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;font-weight:700;
            outline:none;font-size:1rem;
        }
        .small{font-size:0.9rem;color:var(--muted);margin-top:6px}
        .start-actions{display:flex;gap:12px;margin-top:14px;align-items:center}
        .btn{
            background:linear-gradient(180deg,var(--accent),var(--accent-2));
            color:var(--btn-txt);
            padding:12px 18px;border-radius:12px;border:0;font-weight:900;
            box-shadow:0 6px 18px rgba(32,208,168,0.08);
        }
        .ghost{
            background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:10px 14px;border-radius:12px;font-weight:800;
        }

        /* ===== Right: Info / Status Card ===== */
        .side{
            display:flex;flex-direction:column;gap:12px;
            height:100%;
        }
        .status{
            padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border:1px solid rgba(255,255,255,0.03);
        }
        .status h3{margin:0 0 6px 0;font-size:1rem}
        .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(255,255,255,0.03);color:var(--muted);font-weight:800;font-size:0.85rem}

        /* ===== Quiz Screen ===== */
        #screenQuiz{display:flex;flex-direction:column;gap:12px}
        #question{font-size:1.25rem;font-weight:900;margin-bottom:4px}
        #choices{display:grid;gap:10px}
        .choice{
            display:flex;align-items:center;gap:12px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
            border:1px solid rgba(255,255,255,0.04);padding:16px;border-radius:12px;font-weight:800;cursor:pointer;
            transition:transform .12s ease,box-shadow .12s ease,background .18s ease;
        }
        .choice:hover{transform:translateY(-4px);box-shadow:0 10px 24px rgba(10,20,40,0.35)}
        .choice .letter{
            min-width:42px;height:42px;border-radius:10px;display:grid;place-items:center;background:rgba(0,0,0,0.06);font-weight:900;color:var(--muted)
        }
        .choice.correct{background:linear-gradient(90deg, rgba(32,208,168,0.12), rgba(79,158,248,0.08));border-color:rgba(32,208,168,0.35)}
        .choice.wrong{background:linear-gradient(90deg, rgba(255,107,107,0.08), rgba(255,107,107,0.02));border-color:rgba(255,107,107,0.25)}

        /* ===== Controls row (progress + pause + skip) ===== */
        .controls-row{display:flex;align-items:center;gap:12px;margin-top:6px}
        .progress-wrap{flex:1;background:rgba(255,255,255,0.03);height:18px;border-radius:999px;padding:3px}
        .progress-bar{
            height:100%;width:0%;border-radius:999px;background:linear-gradient(90deg,var(--accent),var(--accent-2));transition:width 3s linear;
            box-shadow:0 6px 18px rgba(79,158,248,0.12) inset;
        }
        .icon-btn{padding:10px 12px;border-radius:10px;border:0;background:rgba(255,255,255,0.03);color:var(--muted);font-weight:900;cursor:pointer}
        .icon-btn.pause-on{background:linear-gradient(90deg,var(--danger),#ff9a9a);color:#fff}

        /* ===== End Card ===== */
        #screenEnd{display:flex;flex-direction:column;gap:12px;align-items:flex-start}
        #resultText{font-weight:800;color:var(--muted)}
        .result-actions{display:flex;gap:10px;margin-top:8px}

        /* ===== small helpers ===== */
        .muted{color:var(--muted)}
        .hidden{display:none !important}
    </style>
</head>
<body>
    <div class="app">

        <!-- LEFT: Hauptbereich -->
        <div class="card" id="leftCol">

            <!-- Start -->
            <section id="screenStart">
                <div class="big-title">Quizshow</div>
                <div class="sub">Gesamtschule Bremen West ¬∑ 8. Jahrgang</div>

                <label for="username" class="small muted">Name (wird beim Start kurz gespeichert)</label>
                <input id="username" class="input" type="text" placeholder="Dein Name">

                <label for="adminCode" class="small muted" style="margin-top:8px">Admin-Code (f√ºr Lehrer / Admin-Optionen)</label>
                <input id="adminCode" class="input" type="text" placeholder="Admin-Code">

                <div class="start-actions">
                    <button id="btnStart" class="btn">Start KI-Match ‚ñ∂</button>
                    <button id="btnDemo" class="ghost">Demo</button>
                    <div style="margin-left:auto" class="muted">10 zuf√§llige Fragen</div>
                </div>
            </section>

            <!-- Quiz -->
            <section id="screenQuiz" class="card hidden">
                <div id="question">Fragetext ‚Ä¶</div>
                <div id="choices"></div>

                <div class="controls-row" style="margin-top:12px">
                    <div class="progress-wrap" title="N√§chste Frage in 3s">
                        <div id="progressBar" class="progress-bar"></div>
                    </div>

                    <button id="pauseBtn" class="icon-btn" title="Pause/Resume">‚è∏</button>
                    <button id="skipBtn" class="icon-btn" title="Frage √ºberspringen">‚Ü∑ √úberspringen</button>
                </div>
            </section>

            <!-- Ende -->
            <section id="screenEnd" class="card hidden">
                <h3 style="margin:0">Ergebnis</h3>
                <div id="resultText">Die KI hat gewonnen ‚Äî besser trainiert üòé</div>

                <div class="result-actions">
                    <button id="btnAgain" class="btn">Nochmal spielen</button>
                    <button id="btnHome" class="ghost">Zur Startseite</button>
                </div>
            </section>

        </div>

        <!-- RIGHT: Seitenleiste (Status / Info) -->
        <aside class="side">
            <div class="status card">
                <h3>Spiel-Status</h3>
                <div style="display:flex;gap:10px;align-items:center;margin-top:8px">
                    <div class="badge" id="badgeUser">Spieler: ‚Äî</div>
                    <div class="badge" id="badgeRound">Runde: 0/10</div>
                </div>
                <p class="small muted" style="margin-top:10px">Bot-St√§rke: <span id="botSkill">65%</span></p>
            </div>

            <div class="status card">
                <h3>Letzte Spieler</h3>
                <div id="userList" class="small muted">Keine</div>
            </div>

            <div class="status card">
                <h3>Hinweis</h3>
                <p class="small muted">Der KI-Bot zeigt seine Auswahl an ‚Äî du verlierst automatisch, wenn die KI richtig liegt. Nutze <b>√úberspringen</b> oder beobachte die Antworten.</p>
            </div>
        </aside>
    </div>

    <script>
        /* ===== Fragenpool (erweiterbar) ===== */
        const QUESTIONS=[
            {q:"Wie viele Bundesl√§nder hat Deutschland?",a:["14","16","18","12"],correct:1,cat:"wissen"},
            {q:"Hauptstadt von Bremen ist ‚Ä¶",a:["Bremerhaven","Bremen","Vegesack","Oldenburg"],correct:1,cat:"bremen"},
            {q:"5 ¬∑ 7 = ?",a:["30","32","35","37"],correct:2,cat:"mathe"},
            {q:"Welches Tier ist ein S√§ugetier?",a:["Hai","Delfin","Forelle","Karpfen"],correct:1,cat:"natur"},
            {q:"Was bedeutet ‚ÄöCPU‚Äò?",a:["Central Processing Unit","Central Program Utility","Compute Power Unit","Core Program Unit"],correct:0,cat:"it"},
            {q:"Welche Programmiersprache l√§uft im Browser?",a:["C++","Python","JavaScript","Java"],correct:2,cat:"it"},
            {q:"Der Rhein m√ºndet in ‚Ä¶",a:["Ostsee","Nordsee","Mittelmeer","Schwarzes Meer"],correct:1,cat:"wissen"},
            {q:"9+7¬∑2 = ?",a:["30","32","34","36"],correct:1,cat:"mathe"},
            {q:"Wie nennt man Pflanzenfresser?",a:["Karnivoren","Omnivoren","Herbivoren","Detritivoren"],correct:2,cat:"natur"},
            {q:"Bremens Fu√üballclub?",a:["HSV","Werder","FCSP","H96"],correct:1,cat:"bremen"},
            {q:"Was ist 2^5?",a:["16","32","64","128"],correct:1,cat:"mathe"},
            {q:"HTTP steht f√ºr ‚Ä¶",a:["HyperText Transfer Protocol","High Transfer Text Protocol","Hyperlink Text Transport","Home Transfer Protocol"],correct:0,cat:"it"},
            {q:"Welcher Planet ist der Sonne am n√§chsten?",a:["Venus","Merkur","Mars","Erde"],correct:1,cat:"wissen"},
            {q:"Welche Einheit misst elektrische Stromst√§rke?",a:["Volt","Watt","Ohm","Ampere"],correct:3,cat:"wissen"},
            {q:"Welches Schutzgebiet liegt um Bremen?",a:["Wattenmeer","Bayerischer Wald","S√§chsische Schweiz","Spreewald"],correct:0,cat:"bremen"},
            // du kannst hier weitere Fragen hinzuf√ºgen
        ];

        /* ===== State ===== */
        let state={
            username:"",
            idx:0,
            order:[],
            botSkill:0.65,
            timer:null,
            paused:false,
            lastUsernameForAgain:null
        };

        const $ = s => document.querySelector(s);

        /* ===== Init UI ===== */
        function init(){
            // load users list
            renderUserList();
            $("#btnStart").addEventListener("click", onStart);
            $("#btnDemo").addEventListener("click", startDemo);
            $("#pauseBtn").addEventListener("click", togglePause);
            $("#skipBtn").addEventListener("click", onSkip);
            $("#btnAgain").addEventListener("click", onAgain);
            $("#btnHome").addEventListener("click", ()=>showScreen("start"));
        }
        init();

        /* ===== Helpers ===== */
        function shuffle(a){ return a.slice().sort(()=>Math.random()-0.5); }
        function showScreen(name){
            $("#screenStart").classList.toggle("hidden", name!=="start");
            $("#screenQuiz").classList.toggle("hidden", name!=="quiz");
            $("#screenEnd").classList.toggle("hidden", name!=="end");
        }
        function saveUsername(name){
            if(!name) return;
            let list = JSON.parse(localStorage.getItem("users")||"[]");
            if(!list.includes(name)) list.push(name);
            localStorage.setItem("users", JSON.stringify(list));
            renderUserList();
        }
        function renderUserList(){
            let list = JSON.parse(localStorage.getItem("users")||"[]");
            $("#userList").textContent = list.length? list.slice(-6).reverse().join(", ") : "Keine";
        }

        /* ===== Start / Setup Spiel ===== */
        function onStart(){
            const name = $("#username").value.trim();
            if(!name){ alert("Bitte Namen eingeben"); return; }
            state.username = name;
            state.lastUsernameForAgain = name;
            saveUsername(name);
            startGame();
        }

        function startDemo(){
            $("#username").value = "Demo";
            $("#btnStart").click();
        }

        function startGame(){
            state.idx = 0;
            state.order = shuffle(QUESTIONS).slice(0,10);
            $("#badgeUser").textContent = "Spieler: " + state.username;
            $("#badgeRound").textContent = `Runde: ${state.idx+1}/${state.order.length}`;
            showScreen("quiz");
            renderQuestion();
        }

        /* ===== Render Frage ===== */
        function renderQuestion(){
            clearTimers();
            const q = state.order[state.idx];
            $("#question").textContent = q.q;
            const ch = $("#choices");
            ch.innerHTML = "";

            q.a.forEach((txt,i)=>{
                const btn = document.createElement("button");
                btn.className = "choice";
                btn.innerHTML = `<div class="letter">${String.fromCharCode(65+i)}</div><div style="flex:1">${txt}</div>`;
                btn.addEventListener("click", ()=> pickAnswer(i));
                ch.appendChild(btn);
            });

            // KI-Wahl sichtbar markieren (aber Spieler verliert automatisch falls KI richtig)
            const botChoice = Math.random() < state.botSkill ? q.correct : randomWrong(q.correct, q.a.length);
            // visual feedback: add correct style to botChoice (keine Punkte√§nderung, nur Anzeige)
            setTimeout(()=>{ const el = ch.children[botChoice]; if(el) el.classList.add("correct"); }, 400);

            // Fortschrittsbar starten
            const bar = $("#progressBar");
            bar.style.transition = "none";
            bar.style.width = "0%";
            // Ensure reflow before transition:
            requestAnimationFrame(()=>{ requestAnimationFrame(()=>{ bar.style.transition = "width 3000ms linear"; if(!state.paused) bar.style.width = "100%"; }) });

            // Timer: nach 3s automatisch zur n√§chsten Frage (wenn nicht pausiert)
            if(!state.paused) state.timer = setTimeout(() => {
                // wenn bot richtig ist -> Spieler verliert (animation already shows correct)
                // wir zeigen kurz Wrong-class beim Spieler-Auswahl-Phase nicht n√∂tig ‚Äî direkt next
                nextQuestion();
            }, 3000);

            $("#badgeRound").textContent = `Runde: ${state.idx+1}/${state.order.length}`;
        }

        function randomWrong(correct,n){
            let r = Math.floor(Math.random()*n);
            if(r===correct) r=(r+1)%n;
            return r;
        }

        /* ===== Interaktionen ===== */
        function pickAnswer(i){
            // Spieler verliert automatisch ‚Äî hier geben wir kurz falsche Markierung, then wait for progress bar to move on
            const q = state.order[state.idx];
            const ch = $("#choices");
            // mark chosen as wrong if not correct
            if(i !== q.correct){
                const el = ch.children[i]; if(el) el.classList.add("wrong");
            } else {
                // falls ausversehen richtig, trotzdem verliert der Spieler per Vorgabe ‚Äî mark as wrong visually
                const el = ch.children[i]; if(el) { el.classList.add("wrong"); }
            }
            // no score change; let progress continue to next question automatically
        }

        function onSkip(){
            // skip counts as wrong; jump to next immediately (still show small delay for UX)
            clearTimers();
            const bar = $("#progressBar");
            bar.style.transition = "width 400ms linear";
            bar.style.width = "100%";
            setTimeout(nextQuestion, 420);
        }

        function nextQuestion(){
            clearTimers();
            state.idx++;
            if(state.idx >= state.order.length){
                endGame();
            } else {
                renderQuestion();
            }
        }

        function endGame(){
            showScreen("end");
            $("#resultText").textContent = `Die KI hat gewonnen ‚Äî besser trainiert! Viel Spa√ü trotzdem, ${state.username}.`;
            // Username-Feld auf Startseite leer lassen, au√üer bei "Nochmal spielen"
            $("#username").value = "";
            $("#badgeUser").textContent = "Spieler: ‚Äî";
        }

        /* ===== Pause / Resume ===== */
        function togglePause(){
            state.paused = !state.paused;
            const btn = $("#pauseBtn");
            const bar = $("#progressBar");
            if(state.paused){
                // freeze progress bar
                const computed = getComputedStyle(bar).width;
                const parentW = bar.parentElement.clientWidth;
                const pct = parentW ? (parseFloat(computed) / parentW) * 100 : 0;
                bar.style.transition = "none";
                bar.style.width = pct + "%";
                clearTimers();
                btn.classList.add("pause-on");
                btn.textContent = "‚ñ∂";
            } else {
                // resume remaining
                const parentW = bar.parentElement.clientWidth;
                const curW = parseFloat(getComputedStyle(bar).width);
                const remainingPx = Math.max(0, parentW - curW);
                const remainingRatio = parentW ? (remainingPx / parentW) : 0;
                const remainingMs = Math.max(0, Math.round(remainingRatio * 3000));
                // animate to full
                requestAnimationFrame(()=>{ bar.style.transition = `width ${remainingMs}ms linear`; bar.style.width = "100%"; });
                clearTimers();
                state.timer = setTimeout(nextQuestion, remainingMs);
                btn.classList.remove("pause-on");
                btn.textContent = "‚è∏";
            }
        }

        function clearTimers(){ if(state.timer) { clearTimeout(state.timer); state.timer = null; } }

        /* ===== "Nochmal spielen" Verhalten ===== */
        function onAgain(){
            // set username back to last used only if exists
            if(state.lastUsernameForAgain) $("#username").value = state.lastUsernameForAgain;
            // start game immediately
            $("#btnStart").click();
        }

        /* ===== page load ===== */
        // ensure start username empty on load (per Wunsch)
        window.addEventListener("load", ()=>{
            $("#username").value = "";
            showScreen("start");
            // show stored users (sidebar)
            renderUserList();
        });
    </script>
</body>
</html>
